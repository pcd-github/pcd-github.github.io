{"ast":null,"code":"var _jsxFileName = \"/Users/paul/OneDrive/Documents/code/src/swrve/src/endvaluechart.js\",\n    _s = $RefreshSig$();\n\nimport * as React from \"react\";\nimport * as d3 from \"d3\";\nimport { useState } from \"react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction EndValueChart(props) {\n  _s();\n\n  const maxPctOfStartState = props.maxendvalue / props.startvalue;\n  const svgID = 'endvaluechartsvg';\n  const perRunClass = 'perrunevdata';\n  const margin = {\n    top: 40,\n    right: 65,\n    bottom: 40,\n    left: 65\n  };\n  const totalWidth = 960;\n  const totalHeight = 300;\n  const marginTranslate = \"translate(\" + margin.left + \",\" + margin.top + \")\";\n  const boundedWidth = totalWidth - margin.left - margin.right;\n  const boundedHeight = totalHeight - margin.top - margin.bottom;\n  const thresholdValues = [0, 0.5, 1, 3, 5, 10, 50];\n\n  const cleanupPrev = svg => {\n    const perRunSelect = '.' + perRunClass;\n    d3.selectAll(perRunSelect).remove();\n  };\n\n  const drawHistogram = svg => {\n    cleanupPrev(svg);\n    const numThresholds = thresholdValues.length;\n    var thresholdRange = [];\n    var thresholdInc = boundedWidth / (numThresholds + 1);\n\n    for (var i = 0; i <= thresholdValues.length; i++) {\n      thresholdRange[i] = i * thresholdInc;\n    }\n\n    const xScaleBins = d3.scaleThreshold().domain(thresholdValues).range([0, boundedWidth]);\n    const binFunc = d3.bin().value(function (d) {\n      return d.pctOfStart;\n    }).domain(xScaleBins.domain()).thresholds(50);\n    const bins = binFunc(props.metadata);\n    const yScaleBins = d3.scaleLinear().range([boundedHeight, 0]);\n    yScaleBins.domain([0, d3.max(bins, function (d) {\n      return d.length;\n    })]);\n    svg.append(\"g\").attr(\"class\", perRunClass).attr(\"transform\", \"translate(0,\" + boundedHeight + \")\").call(d3.axisBottom(xScaleBins));\n    svg.append(\"g\").attr(\"class\", perRunClass).call(d3.axisLeft(yScaleBins));\n    svg.selectAll(\"rect\").data(bins).enter().append(\"rect\").attr(\"class\", perRunClass).attr(\"x\", 1).attr(\"transform\", function (d) {\n      return \"translate(\" + xScaleBins(d.x0) + \",\" + yScaleBins(d.length) + \")\";\n    }).attr(\"width\", function (d) {\n      return xScaleBins(d.x1) - xScaleBins(d.x0) - 1;\n    }).attr(\"height\", function (d) {\n      return boundedHeight - yScaleBins(d.length);\n    }).style(\"fill\", \"#69b3a2\");\n    /*           \n    // Add the area\n    svg.append(\"path\")\n     .datum(bins)\n     .attr(\"class\", perRunClass)\n     .attr(\"fill\", \"#cce5df\")\n     .attr(\"stroke\", \"#69b3a2\")\n     .attr(\"stroke-width\", 4.5)\n     .attr(\"d\", d3.area()\n         .x(function(d) { return xScaleBins((d.x1 + d.x0) / 2) })\n         .y0(yScaleBins(0))\n         .y1(function(d) { return yScaleBins(d.length) })\n         );\n                         */\n  };\n\n  React.useEffect(() => {\n    const svgSelect = '#' + svgID;\n    const svg = d3.select(svgSelect).append(\"g\").attr(\"transform\", marginTranslate);\n    drawHistogram(svg); // console.log('endvaluechart effect');\n  }, [props]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(\"svg\", {\n      id: svgID,\n      width: totalWidth,\n      height: totalHeight,\n      children: /*#__PURE__*/_jsxDEV(\"rect\", {\n        style: {\n          opacity: 0\n        },\n        width: boundedWidth,\n        height: boundedHeight,\n        transform: marginTranslate,\n        fill: \"LightGrey\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 93,\n    columnNumber: 9\n  }, this);\n}\n\n_s(EndValueChart, \"OD7bBpZva5O2jO+Puf00hKivP7c=\");\n\n_c = EndValueChart;\n;\nexport default EndValueChart;\n\nvar _c;\n\n$RefreshReg$(_c, \"EndValueChart\");","map":{"version":3,"sources":["/Users/paul/OneDrive/Documents/code/src/swrve/src/endvaluechart.js"],"names":["React","d3","useState","EndValueChart","props","maxPctOfStartState","maxendvalue","startvalue","svgID","perRunClass","margin","top","right","bottom","left","totalWidth","totalHeight","marginTranslate","boundedWidth","boundedHeight","thresholdValues","cleanupPrev","svg","perRunSelect","selectAll","remove","drawHistogram","numThresholds","length","thresholdRange","thresholdInc","i","xScaleBins","scaleThreshold","domain","range","binFunc","bin","value","d","pctOfStart","thresholds","bins","metadata","yScaleBins","scaleLinear","max","append","attr","call","axisBottom","axisLeft","data","enter","x0","x1","style","useEffect","svgSelect","select","opacity"],"mappings":"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","sourcesContent":["import * as React from \"react\";\nimport * as d3 from \"d3\";\nimport {useState} from \"react\";\n\nfunction EndValueChart (props) {\n\n    const maxPctOfStartState = props.maxendvalue / props.startvalue;\n    const svgID = 'endvaluechartsvg';\n    const perRunClass = 'perrunevdata';\n    const margin = { top: 40, right: 65, bottom: 40, left: 65 };\n    const totalWidth = 960;\n    const totalHeight = 300;\n    const marginTranslate = \"translate(\" + margin.left + \",\" + margin.top + \")\";\n    const boundedWidth = totalWidth - margin.left - margin.right;\n    const boundedHeight = totalHeight - margin.top - margin.bottom;\n    const thresholdValues = [0, 0.5, 1, 3, 5, 10, 50];\n\n    const cleanupPrev = (svg) => {\n        const perRunSelect = '.' + perRunClass;\n        d3.selectAll(perRunSelect).remove();\n    }\n\n    const drawHistogram = (svg) => {\n        \n        cleanupPrev(svg);\n        const numThresholds = thresholdValues.length;\n        var thresholdRange = [];\n        var thresholdInc = boundedWidth / (numThresholds + 1);\n\n        for (var i = 0; i <= thresholdValues.length; i++) {\n            thresholdRange[i] = i * thresholdInc;\n        }\n\n        const xScaleBins = d3.scaleThreshold()\n                             .domain(thresholdValues)\n                             .range([0, boundedWidth]);\n        const binFunc = d3.bin()\n                          .value(function(d) { return d.pctOfStart; })   \n                          .domain(xScaleBins.domain())\n                          .thresholds(50); \n        const bins = binFunc(props.metadata);\n        const yScaleBins = d3.scaleLinear()\n                             .range([boundedHeight, 0]);\n        yScaleBins.domain([0, d3.max(bins, function(d) { return d.length; })]);\n        svg.append(\"g\")\n            .attr(\"class\", perRunClass)\n            .attr(\"transform\", \"translate(0,\" + boundedHeight + \")\")\n            .call(d3.axisBottom(xScaleBins));\n        svg.append(\"g\")\n           .attr(\"class\", perRunClass)\n           .call(d3.axisLeft(yScaleBins));\n\n           svg.selectAll(\"rect\")\n              .data(bins)\n              .enter()\n              .append(\"rect\")\n                .attr(\"class\", perRunClass)\n                .attr(\"x\", 1)\n                .attr(\"transform\", function(d) { return \"translate(\" + xScaleBins(d.x0) + \",\" + yScaleBins(d.length) + \")\"; })\n                .attr(\"width\", function(d) { return xScaleBins(d.x1) - xScaleBins(d.x0) -1 ; })\n                .attr(\"height\", function(d) { return boundedHeight - yScaleBins(d.length); })\n                .style(\"fill\", \"#69b3a2\");\n     \n           /*           \n        // Add the area\n        svg.append(\"path\")\n            .datum(bins)\n            .attr(\"class\", perRunClass)\n            .attr(\"fill\", \"#cce5df\")\n            .attr(\"stroke\", \"#69b3a2\")\n            .attr(\"stroke-width\", 4.5)\n            .attr(\"d\", d3.area()\n                .x(function(d) { return xScaleBins((d.x1 + d.x0) / 2) })\n                .y0(yScaleBins(0))\n                .y1(function(d) { return yScaleBins(d.length) })\n                );\n                                */\n\n    }\n\n    React.useEffect(() => {\n\n        const svgSelect = '#' + svgID;\n        const svg = d3.select(svgSelect)\n                      .append(\"g\")\n                      .attr(\"transform\", marginTranslate);\n\n        drawHistogram(svg);\n        // console.log('endvaluechart effect');\n    }, [props] );\n\n    return (\n        <div>\n            <svg id={svgID}  \n                width={totalWidth}\n                height={totalHeight} \n             >\n                <rect\n                    style={{ opacity:0 }}\n                    width={boundedWidth}\n                    height={boundedHeight}\n                    transform={marginTranslate}\n                    fill='LightGrey'\n                 >\n\n                </rect>\n            </svg>\n        </div>\n    );\n};\n\nexport default EndValueChart;\n"]},"metadata":{},"sourceType":"module"}